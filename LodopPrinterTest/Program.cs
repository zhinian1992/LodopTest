using System;
using System.Collections.Generic;
using System.Text;
using LodopPrinter;

namespace LodopPrinterTest
{
    class Program
    {
        static private string strPrintData = "[{\"top\":\"135.0\",\"left\":\"135.0\",\"width\":\"105.0\",\"height\":\"30.0\",\"type\":\"1\",\"value\":\"2019-09-29\"},{\"top\":\"135.0\",\"left\":\"240.0\",\"width\":\"70.0\",\"height\":\"30.0\",\"type\":\"1\",\"value\":\"左上臂\"},{\"top\":\"135.0\",\"left\":\"310.0\",\"width\":\"90.0\",\"height\":\"30.0\",\"type\":\"1\",\"value\":\"s1641-1\"},{\"top\":\"135.0\",\"left\":\"400.0\",\"width\":\"95.0\",\"height\":\"30.0\",\"type\":\"1\",\"value\":\"\"},{\"top\":\"135.0\",\"left\":\"495.0\",\"width\":\"95.0\",\"height\":\"30.0\",\"type\":\"1\",\"value\":\"成都生物\"},{\"top\":\"135.0\",\"left\":\"590.0\",\"width\":\"115.0\",\"height\":\"30.0\",\"type\":\"1\",\"value\":\"梨园卫生院\"},{\"top\":\"165.0\",\"left\":\"135.0\",\"width\":\"105.0\",\"height\":\"30.0\",\"type\":\"1\",\"value\":\"\"},{\"top\":\"165.0\",\"left\":\"240.0\",\"width\":\"70.0\",\"height\":\"30.0\",\"type\":\"1\",\"value\":\"\"},{\"top\":\"165.0\",\"left\":\"310.0\",\"width\":\"90.0\",\"height\":\"30.0\",\"type\":\"1\",\"value\":\"\"},{\"top\":\"165.0\",\"left\":\"400.0\",\"width\":\"95.0\",\"height\":\"30.0\",\"type\":\"1\",\"value\":\"\"},{\"top\":\"165.0\",\"left\":\"495.0\",\"width\":\"95.0\",\"height\":\"30.0\",\"type\":\"1\",\"value\":\"\"},{\"top\":\"165.0\",\"left\":\"590.0\",\"width\":\"115.0\",\"height\":\"30.0\",\"type\":\"1\",\"value\":\"\"},{\"top\":\"195.0\",\"left\":\"135.0\",\"width\":\"105.0\",\"height\":\"30.0\",\"type\":\"1\",\"value\":\"\"},{\"top\":\"195.0\",\"left\":\"240.0\",\"width\":\"70.0\",\"height\":\"30.0\",\"type\":\"1\",\"value\":\"\"},{\"top\":\"195.0\",\"left\":\"310.0\",\"width\":\"90.0\",\"height\":\"30.0\",\"type\":\"1\",\"value\":\"\"},{\"top\":\"195.0\",\"left\":\"400.0\",\"width\":\"95.0\",\"height\":\"30.0\",\"type\":\"1\",\"value\":\"\"},{\"top\":\"195.0\",\"left\":\"495.0\",\"width\":\"95.0\",\"height\":\"30.0\",\"type\":\"1\",\"value\":\"\"},{\"top\":\"195.0\",\"left\":\"590.0\",\"width\":\"115.0\",\"height\":\"30.0\",\"type\":\"1\",\"value\":\"\"},{\"top\":\"225.0\",\"left\":\"135.0\",\"width\":\"105.0\",\"height\":\"30.0\",\"type\":\"1\",\"value\":\"\"},{\"top\":\"225.0\",\"left\":\"240.0\",\"width\":\"70.0\",\"height\":\"30.0\",\"type\":\"1\",\"value\":\"\"},{\"top\":\"225.0\",\"left\":\"310.0\",\"width\":\"90.0\",\"height\":\"30.0\",\"type\":\"1\",\"value\":\"\"},{\"top\":\"225.0\",\"left\":\"400.0\",\"width\":\"95.0\",\"height\":\"30.0\",\"type\":\"1\",\"value\":\"\"},{\"top\":\"225.0\",\"left\":\"495.0\",\"width\":\"95.0\",\"height\":\"30.0\",\"type\":\"1\",\"value\":\"\"},{\"top\":\"225.0\",\"left\":\"590.0\",\"width\":\"115.0\",\"height\":\"30.0\",\"type\":\"1\",\"value\":\"\"},{\"top\":\"255.0\",\"left\":\"135.0\",\"width\":\"105.0\",\"height\":\"30.0\",\"type\":\"1\",\"value\":\"2019-09-26\"},{\"top\":\"255.0\",\"left\":\"240.0\",\"width\":\"70.0\",\"height\":\"30.0\",\"type\":\"1\",\"value\":\"口服\"},{\"top\":\"255.0\",\"left\":\"310.0\",\"width\":\"90.0\",\"height\":\"30.0\",\"type\":\"1\",\"value\":\"201712200\"},{\"top\":\"255.0\",\"left\":\"400.0\",\"width\":\"95.0\",\"height\":\"30.0\",\"type\":\"1\",\"value\":\"\"},{\"top\":\"255.0\",\"left\":\"495.0\",\"width\":\"95.0\",\"height\":\"30.0\",\"type\":\"1\",\"value\":\"北京生物\"},{\"top\":\"255.0\",\"left\":\"590.0\",\"width\":\"115.0\",\"height\":\"30.0\",\"type\":\"1\",\"value\":\"梨园卫生院\"},{\"top\":\"285.0\",\"left\":\"135.0\",\"width\":\"105.0\",\"height\":\"30.0\",\"type\":\"1\",\"value\":\"\"},{\"top\":\"285.0\",\"left\":\"240.0\",\"width\":\"70.0\",\"height\":\"30.0\",\"type\":\"1\",\"value\":\"\"},{\"top\":\"285.0\",\"left\":\"310.0\",\"width\":\"90.0\",\"height\":\"30.0\",\"type\":\"1\",\"value\":\"\"},{\"top\":\"285.0\",\"left\":\"400.0\",\"width\":\"95.0\",\"height\":\"30.0\",\"type\":\"1\",\"value\":\"\"},{\"top\":\"285.0\",\"left\":\"495.0\",\"width\":\"95.0\",\"height\":\"30.0\",\"type\":\"1\",\"value\":\"\"},{\"top\":\"285.0\",\"left\":\"590.0\",\"width\":\"115.0\",\"height\":\"30.0\",\"type\":\"1\",\"value\":\"\"},{\"top\":\"315.0\",\"left\":\"135.0\",\"width\":\"105.0\",\"height\":\"30.0\",\"type\":\"1\",\"value\":\"\"},{\"top\":\"315.0\",\"left\":\"240.0\",\"width\":\"70.0\",\"height\":\"30.0\",\"type\":\"1\",\"value\":\"\"},{\"top\":\"315.0\",\"left\":\"310.0\",\"width\":\"90.0\",\"height\":\"30.0\",\"type\":\"1\",\"value\":\"\"},{\"top\":\"315.0\",\"left\":\"400.0\",\"width\":\"95.0\",\"height\":\"30.0\",\"type\":\"1\",\"value\":\"\"},{\"top\":\"315.0\",\"left\":\"495.0\",\"width\":\"95.0\",\"height\":\"30.0\",\"type\":\"1\",\"value\":\"\"},{\"top\":\"315.0\",\"left\":\"590.0\",\"width\":\"115.0\",\"height\":\"30.0\",\"type\":\"1\",\"value\":\"\"},{\"top\":\"345.0\",\"left\":\"135.0\",\"width\":\"105.0\",\"height\":\"30.0\",\"type\":\"1\",\"value\":\"\"},{\"top\":\"345.0\",\"left\":\"240.0\",\"width\":\"70.0\",\"height\":\"30.0\",\"type\":\"1\",\"value\":\"\"},{\"top\":\"345.0\",\"left\":\"310.0\",\"width\":\"90.0\",\"height\":\"30.0\",\"type\":\"1\",\"value\":\"\"},{\"top\":\"345.0\",\"left\":\"400.0\",\"width\":\"95.0\",\"height\":\"30.0\",\"type\":\"1\",\"value\":\"\"},{\"top\":\"345.0\",\"left\":\"495.0\",\"width\":\"95.0\",\"height\":\"30.0\",\"type\":\"1\",\"value\":\"\"},{\"top\":\"345.0\",\"left\":\"590.0\",\"width\":\"115.0\",\"height\":\"30.0\",\"type\":\"1\",\"value\":\"\"},{\"top\":\"375.0\",\"left\":\"135.0\",\"width\":\"105.0\",\"height\":\"30.0\",\"type\":\"1\",\"value\":\"\"},{\"top\":\"375.0\",\"left\":\"240.0\",\"width\":\"70.0\",\"height\":\"30.0\",\"type\":\"1\",\"value\":\"\"},{\"top\":\"375.0\",\"left\":\"310.0\",\"width\":\"90.0\",\"height\":\"30.0\",\"type\":\"1\",\"value\":\"\"},{\"top\":\"375.0\",\"left\":\"400.0\",\"width\":\"95.0\",\"height\":\"30.0\",\"type\":\"1\",\"value\":\"\"},{\"top\":\"375.0\",\"left\":\"495.0\",\"width\":\"95.0\",\"height\":\"30.0\",\"type\":\"1\",\"value\":\"\"},{\"top\":\"375.0\",\"left\":\"590.0\",\"width\":\"115.0\",\"height\":\"30.0\",\"type\":\"1\",\"value\":\"\"},{\"top\":\"405.0\",\"left\":\"135.0\",\"width\":\"105.0\",\"height\":\"30.0\",\"type\":\"1\",\"value\":\"\"},{\"top\":\"405.0\",\"left\":\"240.0\",\"width\":\"70.0\",\"height\":\"30.0\",\"type\":\"1\",\"value\":\"\"},{\"top\":\"405.0\",\"left\":\"310.0\",\"width\":\"90.0\",\"height\":\"30.0\",\"type\":\"1\",\"value\":\"\"},{\"top\":\"405.0\",\"left\":\"400.0\",\"width\":\"95.0\",\"height\":\"30.0\",\"type\":\"1\",\"value\":\"\"},{\"top\":\"405.0\",\"left\":\"495.0\",\"width\":\"95.0\",\"height\":\"30.0\",\"type\":\"1\",\"value\":\"\"},{\"top\":\"405.0\",\"left\":\"590.0\",\"width\":\"115.0\",\"height\":\"30.0\",\"type\":\"1\",\"value\":\"\"},{\"top\":\"435.0\",\"left\":\"135.0\",\"width\":\"105.0\",\"height\":\"30.0\",\"type\":\"1\",\"value\":\"\"},{\"top\":\"435.0\",\"left\":\"240.0\",\"width\":\"70.0\",\"height\":\"30.0\",\"type\":\"1\",\"value\":\"\"},{\"top\":\"435.0\",\"left\":\"310.0\",\"width\":\"90.0\",\"height\":\"30.0\",\"type\":\"1\",\"value\":\"\"},{\"top\":\"435.0\",\"left\":\"400.0\",\"width\":\"95.0\",\"height\":\"30.0\",\"type\":\"1\",\"value\":\"\"},{\"top\":\"435.0\",\"left\":\"495.0\",\"width\":\"95.0\",\"height\":\"30.0\",\"type\":\"1\",\"value\":\"\"},{\"top\":\"435.0\",\"left\":\"590.0\",\"width\":\"115.0\",\"height\":\"30.0\",\"type\":\"1\",\"value\":\"\"},{\"top\":\"465.0\",\"left\":\"135.0\",\"width\":\"105.0\",\"height\":\"30.0\",\"type\":\"1\",\"value\":\"\"},{\"top\":\"465.0\",\"left\":\"240.0\",\"width\":\"70.0\",\"height\":\"30.0\",\"type\":\"1\",\"value\":\"\"},{\"top\":\"465.0\",\"left\":\"310.0\",\"width\":\"90.0\",\"height\":\"30.0\",\"type\":\"1\",\"value\":\"\"},{\"top\":\"465.0\",\"left\":\"400.0\",\"width\":\"95.0\",\"height\":\"30.0\",\"type\":\"1\",\"value\":\"\"},{\"top\":\"465.0\",\"left\":\"495.0\",\"width\":\"95.0\",\"height\":\"30.0\",\"type\":\"1\",\"value\":\"\"},{\"top\":\"465.0\",\"left\":\"590.0\",\"width\":\"115.0\",\"height\":\"30.0\",\"type\":\"1\",\"value\":\"\"},{\"top\":\"670.0\",\"left\":\"135.0\",\"width\":\"105.0\",\"height\":\"30.0\",\"type\":\"1\",\"value\":\"\"},{\"top\":\"670.0\",\"left\":\"240.0\",\"width\":\"70.0\",\"height\":\"30.0\",\"type\":\"1\",\"value\":\"\"},{\"top\":\"670.0\",\"left\":\"310.0\",\"width\":\"90.0\",\"height\":\"30.0\",\"type\":\"1\",\"value\":\"\"},{\"top\":\"670.0\",\"left\":\"400.0\",\"width\":\"95.0\",\"height\":\"30.0\",\"type\":\"1\",\"value\":\"\"},{\"top\":\"670.0\",\"left\":\"495.0\",\"width\":\"95.0\",\"height\":\"30.0\",\"type\":\"1\",\"value\":\"\"},{\"top\":\"670.0\",\"left\":\"590.0\",\"width\":\"115.0\",\"height\":\"30.0\",\"type\":\"1\",\"value\":\"\"},{\"top\":\"700.0\",\"left\":\"135.0\",\"width\":\"105.0\",\"height\":\"30.0\",\"type\":\"1\",\"value\":\"\"},{\"top\":\"700.0\",\"left\":\"240.0\",\"width\":\"70.0\",\"height\":\"30.0\",\"type\":\"1\",\"value\":\"\"},{\"top\":\"700.0\",\"left\":\"310.0\",\"width\":\"90.0\",\"height\":\"30.0\",\"type\":\"1\",\"value\":\"\"},{\"top\":\"700.0\",\"left\":\"400.0\",\"width\":\"95.0\",\"height\":\"30.0\",\"type\":\"1\",\"value\":\"\"},{\"top\":\"700.0\",\"left\":\"495.0\",\"width\":\"95.0\",\"height\":\"30.0\",\"type\":\"1\",\"value\":\"\"},{\"top\":\"700.0\",\"left\":\"590.0\",\"width\":\"115.0\",\"height\":\"30.0\",\"type\":\"1\",\"value\":\"\"},{\"top\":\"730.0\",\"left\":\"135.0\",\"width\":\"105.0\",\"height\":\"30.0\",\"type\":\"1\",\"value\":\"\"},{\"top\":\"730.0\",\"left\":\"240.0\",\"width\":\"70.0\",\"height\":\"30.0\",\"type\":\"1\",\"value\":\"\"},{\"top\":\"730.0\",\"left\":\"310.0\",\"width\":\"90.0\",\"height\":\"30.0\",\"type\":\"1\",\"value\":\"\"},{\"top\":\"730.0\",\"left\":\"400.0\",\"width\":\"95.0\",\"height\":\"30.0\",\"type\":\"1\",\"value\":\"\"},{\"top\":\"730.0\",\"left\":\"495.0\",\"width\":\"95.0\",\"height\":\"30.0\",\"type\":\"1\",\"value\":\"\"},{\"top\":\"730.0\",\"left\":\"590.0\",\"width\":\"115.0\",\"height\":\"30.0\",\"type\":\"1\",\"value\":\"\"},{\"top\":\"760.0\",\"left\":\"135.0\",\"width\":\"105.0\",\"height\":\"30.0\",\"type\":\"1\",\"value\":\"\"},{\"top\":\"760.0\",\"left\":\"240.0\",\"width\":\"70.0\",\"height\":\"30.0\",\"type\":\"1\",\"value\":\"\"},{\"top\":\"760.0\",\"left\":\"310.0\",\"width\":\"90.0\",\"height\":\"30.0\",\"type\":\"1\",\"value\":\"\"},{\"top\":\"760.0\",\"left\":\"400.0\",\"width\":\"95.0\",\"height\":\"30.0\",\"type\":\"1\",\"value\":\"\"},{\"top\":\"760.0\",\"left\":\"495.0\",\"width\":\"95.0\",\"height\":\"30.0\",\"type\":\"1\",\"value\":\"\"},{\"top\":\"760.0\",\"left\":\"590.0\",\"width\":\"115.0\",\"height\":\"30.0\",\"type\":\"1\",\"value\":\"\"},{\"top\":\"790.0\",\"left\":\"135.0\",\"width\":\"105.0\",\"height\":\"30.0\",\"type\":\"1\",\"value\":\"\"},{\"top\":\"790.0\",\"left\":\"240.0\",\"width\":\"70.0\",\"height\":\"30.0\",\"type\":\"1\",\"value\":\"\"},{\"top\":\"790.0\",\"left\":\"310.0\",\"width\":\"90.0\",\"height\":\"30.0\",\"type\":\"1\",\"value\":\"\"},{\"top\":\"790.0\",\"left\":\"400.0\",\"width\":\"95.0\",\"height\":\"30.0\",\"type\":\"1\",\"value\":\"\"},{\"top\":\"790.0\",\"left\":\"495.0\",\"width\":\"95.0\",\"height\":\"30.0\",\"type\":\"1\",\"value\":\"\"},{\"top\":\"790.0\",\"left\":\"590.0\",\"width\":\"115.0\",\"height\":\"30.0\",\"type\":\"1\",\"value\":\"\"},{\"top\":\"820.0\",\"left\":\"135.0\",\"width\":\"105.0\",\"height\":\"30.0\",\"type\":\"1\",\"value\":\"\"},{\"top\":\"820.0\",\"left\":\"240.0\",\"width\":\"70.0\",\"height\":\"30.0\",\"type\":\"1\",\"value\":\"\"},{\"top\":\"820.0\",\"left\":\"310.0\",\"width\":\"90.0\",\"height\":\"30.0\",\"type\":\"1\",\"value\":\"\"},{\"top\":\"820.0\",\"left\":\"400.0\",\"width\":\"95.0\",\"height\":\"30.0\",\"type\":\"1\",\"value\":\"\"},{\"top\":\"820.0\",\"left\":\"495.0\",\"width\":\"95.0\",\"height\":\"30.0\",\"type\":\"1\",\"value\":\"\"},{\"top\":\"820.0\",\"left\":\"590.0\",\"width\":\"115.0\",\"height\":\"30.0\",\"type\":\"1\",\"value\":\"\"},{\"top\":\"850.0\",\"left\":\"135.0\",\"width\":\"105.0\",\"height\":\"30.0\",\"type\":\"1\",\"value\":\"\"},{\"top\":\"850.0\",\"left\":\"240.0\",\"width\":\"70.0\",\"height\":\"30.0\",\"type\":\"1\",\"value\":\"\"},{\"top\":\"850.0\",\"left\":\"310.0\",\"width\":\"90.0\",\"height\":\"30.0\",\"type\":\"1\",\"value\":\"\"},{\"top\":\"850.0\",\"left\":\"400.0\",\"width\":\"95.0\",\"height\":\"30.0\",\"type\":\"1\",\"value\":\"\"},{\"top\":\"850.0\",\"left\":\"495.0\",\"width\":\"95.0\",\"height\":\"30.0\",\"type\":\"1\",\"value\":\"\"},{\"top\":\"850.0\",\"left\":\"590.0\",\"width\":\"115.0\",\"height\":\"30.0\",\"type\":\"1\",\"value\":\"\"}]";

        static void Main(string[] args)
        {
            /* 测试打印 */
            printTest();

            Console.ReadKey();
        }

        static private void printTest()
        {
            string strError = "";
            PrintManager printer = new PrintManager();
            bool bRet = printer.preview(strPrintData, ref strError);
            if (bRet)
                Console.WriteLine("打印成功!");
            else
            {
                Console.WriteLine("打印失败!错误信息为:");
                Console.WriteLine(strError);
            }
        }
    } 
}
